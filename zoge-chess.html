<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ZOGE Chess</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #ff6b6b, #ffd93d);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }
    .container {
      text-align: center;
      width: 95vw;
      max-width: 600px;
    }
    h1 {
      font-size: 1.6rem;
      margin-bottom: 10px;
      color: #fff;
      text-shadow: 1px 1px 2px #000;
    }
    #chessboard {
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.4);
      touch-action: manipulation;
    }
    #status {
      margin-top: 10px;
      font-size: 1.1rem;
      font-weight: bold;
      color: #fff;
      text-shadow: 1px 1px 2px #000;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ZOGE Chess</h1>
    <canvas id="chessboard"></canvas>
    <div id="status">White's turn</div>
  </div>

<script>
const canvas = document.getElementById("chessboard");
const ctx = canvas.getContext("2d");
let cellSize;

// resize dynamically
function resizeBoard() {
  cellSize = Math.min(window.innerWidth * 0.95 / 8, 70);
  canvas.width = cellSize * 8;
  canvas.height = cellSize * 8;
  drawBoard();
}

// piece images
const pieces = {
  'wp': 'https://upload.wikimedia.org/wikipedia/commons/0/04/Chess_plt60.png',
  'wn': 'https://upload.wikimedia.org/wikipedia/commons/2/28/Chess_nlt60.png',
  'wb': 'https://upload.wikimedia.org/wikipedia/commons/9/9b/Chess_blt60.png',
  'wr': 'https://upload.wikimedia.org/wikipedia/commons/a/a0/Chess_rlt60.png',
  'wq': 'https://upload.wikimedia.org/wikipedia/commons/4/49/Chess_qlt60.png',
  'wk': 'https://upload.wikimedia.org/wikipedia/commons/3/3b/Chess_klt60.png',
  'bp': 'https://upload.wikimedia.org/wikipedia/commons/c/cd/Chess_pdt60.png',
  'bn': 'https://upload.wikimedia.org/wikipedia/commons/f/f1/Chess_ndt60.png',
  'bb': 'https://upload.wikimedia.org/wikipedia/commons/8/81/Chess_bdt60.png',
  'br': 'https://upload.wikimedia.org/wikipedia/commons/a/af/Chess_rdt60.png',
  'bq': 'https://upload.wikimedia.org/wikipedia/commons/8/8e/Chess_qdt60.png',
  'bk': 'https://upload.wikimedia.org/wikipedia/commons/e/e3/Chess_kdt60.png'
};

const images = {};
let loaded = 0;
const totalImages = Object.keys(pieces).length;

function loadImages() {
  for (let key in pieces) {
    images[key] = new Image();
    images[key].onload = () => {
      loaded++;
      if (loaded === totalImages) {
        resizeBoard();
      }
    };
    images[key].src = pieces[key];
  }
}

// board state
let board = [
  ['br','bn','bb','bq','bk','bb','bn','br'],
  ['bp','bp','bp','bp','bp','bp','bp','bp'],
  ['','','','','','','',''],
  ['','','','','','','',''],
  ['','','','','','','',''],
  ['','','','','','','',''],
  ['wp','wp','wp','wp','wp','wp','wp','wp'],
  ['wr','wn','wb','wq','wk','wb','wn','wr']
];

let selected = null;
let turn = "w";

// draw board
function drawBoard() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  for (let y=0; y<8; y++) {
    for (let x=0; x<8; x++) {
      ctx.fillStyle = (x+y)%2===0 ? "#f0d9b5" : "#b58863";
      ctx.fillRect(x*cellSize, y*cellSize, cellSize, cellSize);

      let piece = board[y][x];
      if (piece) {
        ctx.drawImage(images[piece], x*cellSize, y*cellSize, cellSize, cellSize);
      }
    }
  }
  if (selected) {
    ctx.fillStyle = "rgba(255,255,0,0.4)";
    ctx.fillRect(selected.x*cellSize, selected.y*cellSize, cellSize, cellSize);
  }
  document.getElementById("status").textContent = (turn==="w"?"White":"Black") + "'s turn";
}

// moves
function getMoves(piece, x, y) {
  const moves = [];
  if (!piece) return moves;
  const color = piece[0], type = piece[1];

  if (type==="p") {
    const dir = color==="w" ? -1 : 1;
    if (!board[y+dir]?.[x]) moves.push({x,y:y+dir});
    if ((color==="w" && y===6)||(color==="b"&&y===1)) {
      if (!board[y+dir]?.[x] && !board[y+2*dir]?.[x]) moves.push({x,y:y+2*dir});
    }
    for (let dx of [-1,1]) {
      if (board[y+dir]?.[x+dx] && board[y+dir][x+dx][0]!==color)
        moves.push({x:x+dx,y:y+dir});
    }
  }

  if (type==="r"||type==="q") {
    [[1,0],[-1,0],[0,1],[0,-1]].forEach(([dx,dy])=>{
      for (let i=1;i<8;i++) {
        let nx=x+dx*i, ny=y+dy*i;
        if(nx<0||ny<0||nx>7||ny>7) break;
        if (!board[ny][nx]) moves.push({x:nx,y:ny});
        else { if (board[ny][nx][0]!==color) moves.push({x:nx,y:ny}); break; }
      }
    });
  }

  if (type==="b"||type==="q") {
    [[1,1],[1,-1],[-1,1],[-1,-1]].forEach(([dx,dy])=>{
      for (let i=1;i<8;i++) {
        let nx=x+dx*i, ny=y+dy*i;
        if(nx<0||ny<0||nx>7||ny>7) break;
        if (!board[ny][nx]) moves.push({x:nx,y:ny});
        else { if (board[ny][nx][0]!==color) moves.push({x:nx,y:ny}); break; }
      }
    });
  }

  if (type==="n") {
    [[1,2],[2,1],[-1,2],[-2,1],[1,-2],[2,-1],[-1,-2],[-2,-1]].forEach(([dx,dy])=>{
      let nx=x+dx, ny=y+dy;
      if(nx>=0&&ny>=0&&nx<8&&ny<8 && (!board[ny][nx]||board[ny][nx][0]!==color))
        moves.push({x:nx,y:ny});
    });
  }

  if (type==="k") {
    for (let dx=-1;dx<=1;dx++)for(let dy=-1;dy<=1;dy++){
      if(dx===0&&dy===0)continue;
      let nx=x+dx, ny=y+dy;
      if(nx>=0&&ny>=0&&nx<8&&ny<8 && (!board[ny][nx]||board[ny][nx][0]!==color))
        moves.push({x:nx,y:ny});
    }
  }

  return moves;
}

// interaction
function handleInteraction(clientX, clientY) {
  const rect = canvas.getBoundingClientRect();
  const x = Math.floor((clientX-rect.left)/cellSize);
  const y = Math.floor((clientY-rect.top)/cellSize);

  if (selected) {
    const moves = getMoves(board[selected.y][selected.x], selected.x, selected.y);
    if (moves.some(m=>m.x===x&&m.y===y)) {
      board[y][x] = board[selected.y][selected.x];
      board[selected.y][selected.x] = '';
      selected = null;
      turn = turn==="w"?"b":"w";
    } else {
      selected = null;
    }
  } else {
    if (board[y][x] && board[y][x][0]===turn) selected={x,y};
  }
  drawBoard();
}

canvas.addEventListener("click",e=>handleInteraction(e.clientX,e.clientY));
canvas.addEventListener("touchstart",e=>{
  e.preventDefault();
  handleInteraction(e.touches[0].clientX,e.touches[0].clientY);
},{passive:false});

window.addEventListener("resize", resizeBoard);

loadImages();
</script>
</body>
</html>
